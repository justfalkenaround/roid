'use script';

/*------GLOBAL VARIABLES HOLDING THE DATA-URL WEB WORKERS------*/
const ASTEROID_WORKER = 'data:text/javascript;base64,J3VzZSBzdHJpY3QnOwoKZnVuY3Rpb24gZGlzdGFuY2UoaW5wdXQsIHNlY29uZCkgewogIGNvbnN0IGR4ID0gaW5wdXRbMF0gLSBzZWNvbmRbMF07CiAgY29uc3QgZHkgPSBpbnB1dFsxXSAtIHNlY29uZFsxXTsKICBjb25zdCBkeiA9IGlucHV0WzJdIC0gc2Vjb25kWzJdOwogIHJldHVybiBfZGlzdGFuY2UoZHgsIGR5LCBkeik7Cn0KCmZ1bmN0aW9uIF9kaXN0YW5jZShkeCwgZHksIGR6KSB7CiAgcmV0dXJuIE1hdGgucG93KE1hdGgucG93KGR6LCAyKSArIE1hdGgucG93KE1hdGgucG93KE1hdGgucG93KGR4LCAyKSArIE1hdGgucG93KGR5LCAyKSwgMC41KSwgMiksIDAuNSk7Cn0KCm9ubWVzc2FnZSA9IChvYmopID0+IHsKICBjb25zdCBwb3NpdGlvbnMgPSBvYmouZGF0YVswXTsKICBjb25zdCBpZHMgPSBvYmouZGF0YVsxXTsKICBjb25zdCByYWRzID0gb2JqLmRhdGFbMl07CiAgbGV0IHJlc3VsdHMgPSBbXTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc2l0aW9ucy5sZW5ndGg7IGkrKykgewogICAgY29uc3QgcDEgPSBwb3NpdGlvbnNbaV07CiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBvc2l0aW9ucy5sZW5ndGg7IGorKykgewogICAgICBjb25zdCBwMiA9IHBvc2l0aW9uc1tqXTsKICAgICAgaWYgKGkgPT09IGopIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBkaXN0ID0gZGlzdGFuY2UocDEsIHAyKTsKICAgICAgaWYgKGRpc3QgPCByYWRzW2ldICsgcmFkc1tqXSAtIDUpIHsKICAgICAgICByZXN1bHRzLnB1c2goaWRzW2ldKTsKICAgICAgICByZXN1bHRzLnB1c2goaWRzW2pdKTsKICAgICAgfQogICAgfQogIH0KICBwb3N0TWVzc2FnZShyZXN1bHRzKTsKfTs=';

const PROJECTILE_WORKER = 'data:text/javascript;base64,J3VzZSBzdHJpY3QnOwoKZnVuY3Rpb24gZGl2aWRlZEJ5TnVtYmVyKGlucHV0LCBzZWNvbmQpIHsKICBjb25zdCBkeCA9IGlucHV0WzBdIC8gc2Vjb25kOwogIGNvbnN0IGR5ID0gaW5wdXRbMV0gLyBzZWNvbmQ7CiAgY29uc3QgZHogPSBpbnB1dFsyXSAvIHNlY29uZDsKICByZXR1cm4gW2R4LCBkeSwgZHpdOwp9CgpmdW5jdGlvbiB0aW1lc051bWJlcihpbnB1dCwgc2Vjb25kKSB7CiAgY29uc3QgZHggPSBpbnB1dFswXSAqIHNlY29uZDsKICBjb25zdCBkeSA9IGlucHV0WzFdICogc2Vjb25kOwogIGNvbnN0IGR6ID0gaW5wdXRbMl0gKiBzZWNvbmQ7CiAgcmV0dXJuIFtkeCwgZHksIGR6XTsKfQoKZnVuY3Rpb24gbWludXMoaW5wdXQsIHNlY29uZCkgewogIGNvbnN0IGR4ID0gaW5wdXRbMF0gLSBzZWNvbmRbMF07CiAgY29uc3QgZHkgPSBpbnB1dFsxXSAtIHNlY29uZFsxXTsKICBjb25zdCBkeiA9IGlucHV0WzJdIC0gc2Vjb25kWzJdOwogIHJldHVybiBbZHgsIGR5LCBkel07Cn0KCmZ1bmN0aW9uIGRpc3RhbmNlKGlucHV0LCBzZWNvbmQpIHsKICBjb25zdCBkeCA9IGlucHV0WzBdIC0gc2Vjb25kWzBdOwogIGNvbnN0IGR5ID0gaW5wdXRbMV0gLSBzZWNvbmRbMV07CiAgY29uc3QgZHogPSBpbnB1dFsyXSAtIHNlY29uZFsyXTsKICByZXR1cm4gX2Rpc3RhbmNlKGR4LCBkeSwgZHopOwp9CgpmdW5jdGlvbiBfZGlzdGFuY2UoZHgsIGR5LCBkeikgewogIHJldHVybiBNYXRoLnBvdyhNYXRoLnBvdyhkeiwgMikgKyBNYXRoLnBvdyhNYXRoLnBvdyhNYXRoLnBvdyhkeCwgMikgKyBNYXRoLnBvdyhkeSwgMiksIDAuNSksIDIpLCAwLjUpOwp9Cgpvbm1lc3NhZ2UgPSAob2JqKSA9PiB7CiAgY29uc3QgcG9zaXRpb25zID0gb2JqLmRhdGFbMF07CiAgY29uc3QgaWRzID0gb2JqLmRhdGFbMV07CiAgY29uc3QgcmFkcyA9IG9iai5kYXRhWzJdOwogIGNvbnN0IHZlbG9jaXRpZXMgPSBvYmouZGF0YVszXTsKICBsZXQgcmVzdWx0cyA9IFtdOwogIGZvciAobGV0IGkgPSAwOyBpIDwgcG9zaXRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBwMSA9IHBvc2l0aW9uc1tpXTsKICAgIGlmIChpZHNbaV0uaW5kZXhPZignUFJPSkVDVElMRScpID09PSAtMSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGVsc2UgaWYgKGlkc1tpXS5pbmRleE9mKCdFTkVNWScpICE9PSAtMSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGxldCBoaXQgPSBmYWxzZTsKICAgIGZvciAobGV0IGogPSAwOyBqIDwgcG9zaXRpb25zLmxlbmd0aDsgaisrKSB7CiAgICAgIGlmIChpZHNbal0uaW5kZXhPZignUFJPSkVDVElMRScpID49IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBpZiAoaSA9PT0gaiB8fCBoaXQpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBwMiA9IHBvc2l0aW9uc1tqXTsKICAgICAgY29uc3QgZGl2aWRlciA9IGRpdmlkZWRCeU51bWJlcih2ZWxvY2l0aWVzW2ldLCAxMCk7CiAgICAgIGZvciAobGV0IGYgPSAxOyBmIDw9IDEwOyBmKyspIHsKICAgICAgICBjb25zdCBkaXYgPSB0aW1lc051bWJlcihkaXZpZGVyLCBmKTsKICAgICAgICBjb25zdCBwb3MgPSBtaW51cyhwMSwgZGl2KTsKICAgICAgICBpZiAoZGlzdGFuY2UocG9zLCBwMikgLSByYWRzW2ldIC0gcmFkc1tqXSA8IDEgJiYgIWhpdCkgewogICAgICAgICAgcmVzdWx0cy5wdXNoKGlkc1tpXSk7CiAgICAgICAgICByZXN1bHRzLnB1c2goaWRzW2pdKTsKICAgICAgICAgIGhpdCA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChkaXN0YW5jZShwMSwgcDIpIC0gcmFkc1tpXSAtIHJhZHNbal0gPCAxICYmICFoaXQpIHsKICAgICAgICByZXN1bHRzLnB1c2goaWRzW2ldKTsKICAgICAgICByZXN1bHRzLnB1c2goaWRzW2pdKTsKICAgICAgICBoaXQgPSB0cnVlOwogICAgICB9CiAgICB9CiAgfQogIHBvc3RNZXNzYWdlKHJlc3VsdHMpOwp9Ow==';

const ARTIFACT_WORKER = 'data:text/javascript;base64,J3VzZSBzdHJpY3QnOwoKZnVuY3Rpb24gZGlzdGFuY2UoaW5wdXQsIHNlY29uZCkgewogIGNvbnN0IGR4ID0gaW5wdXRbMF0gLSBzZWNvbmRbMF07CiAgY29uc3QgZHkgPSBpbnB1dFsxXSAtIHNlY29uZFsxXTsKICBjb25zdCBkeiA9IGlucHV0WzJdIC0gc2Vjb25kWzJdOwogIHJldHVybiBfZGlzdGFuY2UoZHgsIGR5LCBkeik7Cn0KCmZ1bmN0aW9uIF9kaXN0YW5jZShkeCwgZHksIGR6KSB7CiAgcmV0dXJuIE1hdGgucG93KE1hdGgucG93KGR6LCAyKSArIE1hdGgucG93KE1hdGgucG93KE1hdGgucG93KGR4LCAyKSArIE1hdGgucG93KGR5LCAyKSwgMC41KSwgMiksIDAuNSk7Cn0KCm9ubWVzc2FnZSA9IChvYmopID0+IHsKICBjb25zdCBwb3NpdGlvbnMgPSBvYmouZGF0YVswXTsKICBjb25zdCBpZHMgPSBvYmouZGF0YVsxXTsKICBjb25zdCByYWRzID0gb2JqLmRhdGFbMl07CiAgbGV0IHJlc3VsdHMgPSBbXTsKICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc2l0aW9ucy5sZW5ndGg7IGkrKykgewogICAgY29uc3QgcDEgPSBwb3NpdGlvbnNbaV07CiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBvc2l0aW9ucy5sZW5ndGg7IGorKykgewogICAgICBjb25zdCBwMiA9IHBvc2l0aW9uc1tqXTsKICAgICAgaWYgKGkgPT09IGopIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBkaXN0ID0gZGlzdGFuY2UocDEsIHAyKTsKICAgICAgaWYgKGRpc3QgPCByYWRzW2ldICsgcmFkc1tqXSAtIDUpIHsKICAgICAgICBpZiAoaWRzW2ldLmluZGV4T2YoJ0FTVEVST0lEJykgPT09IC0xKSB7CiAgICAgICAgICByZXN1bHRzLnB1c2goaWRzW2ldKTsKICAgICAgICB9CiAgICAgICAgaWYgKGlkc1tqXS5pbmRleE9mKCdBU1RFUk9JRCcpID09PSAtMSkgewogICAgICAgICAgcmVzdWx0cy5wdXNoKGlkc1tqXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIHBvc3RNZXNzYWdlKHJlc3VsdHMpOwp9Ow==';

const SHIP_WORKER = 'data:text/javascript;base64,J3VzZSBzdHJpY3QnOwoKZnVuY3Rpb24gZGlzdGFuY2UoaW5wdXQsIHNlY29uZCkgewogIGNvbnN0IGR4ID0gaW5wdXRbMF0gLSBzZWNvbmRbMF07CiAgY29uc3QgZHkgPSBpbnB1dFsxXSAtIHNlY29uZFsxXTsKICBjb25zdCBkeiA9IGlucHV0WzJdIC0gc2Vjb25kWzJdOwogIHJldHVybiBfZGlzdGFuY2UoZHgsIGR5LCBkeik7Cn0KCmZ1bmN0aW9uIF9kaXN0YW5jZShkeCwgZHksIGR6KSB7CiAgcmV0dXJuIE1hdGgucG93KE1hdGgucG93KGR6LCAyKSArIE1hdGgucG93KE1hdGgucG93KE1hdGgucG93KGR4LCAyKSArIE1hdGgucG93KGR5LCAyKSwgMC41KSwgMiksIDAuNSk7Cn0KCm9ubWVzc2FnZSA9IChvYmopID0+IHsKICBjb25zdCBwb3NpdGlvbnMgPSBvYmouZGF0YVswXTsKICBjb25zdCBpZHMgPSBvYmouZGF0YVsxXTsKICBjb25zdCByYWRzID0gb2JqLmRhdGFbMl07CiAgY29uc3Qgc2hpcCA9IG9iai5kYXRhWzNdOwogIGNvbnN0IG5lYXJlc3QgPSB7aWQgOiBudWxsLCBkaXN0YW5jZSA6IEluZmluaXR5LCBoaXQgOiBmYWxzZX07CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NpdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgIGNvbnN0IHAxID0gcG9zaXRpb25zW2ldOwogICAgY29uc3QgZGlzdCA9IGRpc3RhbmNlKHNoaXAsIHAxKTsKICAgIGlmIChkaXN0IC0gcmFkc1tpXSA8IDEwKSB7CiAgICAgIG5lYXJlc3QuaWQgPSBpZHNbaV07CiAgICAgIG5lYXJlc3QuZGlzdGFuY2UgPSBkaXN0IC0gcmFkc1tpXTsKICAgICAgbmVhcmVzdC5oaXQgPSB0cnVlOwogICAgfQogICAgZWxzZSBpZiAoZGlzdCAtIHJhZHNbaV0gPCAyNTAgJiYgZGlzdCArIHJhZHNbaV0gPCBuZWFyZXN0LmRpc3RhbmNlKSB7CiAgICAgIG5lYXJlc3QuaWQgPSBpZHNbaV07CiAgICAgIG5lYXJlc3QuZGlzdGFuY2UgPSBkaXN0IC0gcmFkc1tpXTsKICAgIH0KICB9CiAgcG9zdE1lc3NhZ2UobmVhcmVzdCk7Cn07';